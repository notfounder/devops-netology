# 5.1. Введение в виртуализацию. Типы и функции гипервизоров. Обзор рынка вендоров и областей применения.

## Задача №1

**Вопрос:** Опишите кратко, как вы поняли: в чем основное отличие полной (аппаратной) виртуализации, паравиртуализации и виртуализации на основе ОС.

**Ответ:**

**Аппаратная виртуализация** не требует установки ОС на физический
сервер, сам гипервизор является операционной системой. Гостевые системы
изолированы и управляются гипервизором, установленным на физический сервер.

Аппаратная виртуализация обеспечивает функции:

1. Виртуализация процессоров. Все что доступно
   физическому серверу (процессор), становятся доступны и виртуальным машинам.
2. Графическое представление. Виртуализация
   обеспечивает доступ гостевым ОС к графическому адаптеру и его функциям
   независимо друг от друга.
3. Ввод/вывод (I/O). Гипервизор разделяет доступ к
   устройствам ввода/вывода и другой периферией между виртуальными системами без
   конфликтов и зависаний.

Все, что нужно для полнофункционального изолированного функционирования
приложений на базе ВМ, при этом ОС на ВМ ведет себя ровно, если бы она стояла
на физическом сервере в основе. Происходит полная эмуляция всех необходимых аппаратных
устройств.

Примеры: ESX/ESXi/Xen-Server

**Паравиртуализация** – ОС установлена на физический сервер (Linux\Windows) и уже в самой ОС установлен гипервизор
для виртуализации. В данном

Примеры: KVM,
Parallels, VirtualBox, VMware Horizon.

**Виртуализация уровня ОС** – нет гипервизора, на физический
сервер установлена ОС и ВМ используют ядро хостовой ОС. В ОС есть необходимые
модули для полной изоляции ВМ.

Примеры: Docker, OpenShift.

## Задача №2


| **Требования**                                                                                     | **Решение**                                                             | **Пояснения**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| -------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Высоконагруженная база данных, чувствительная к отказу.      | физический сервер                                              | чувствительная к отказу БД использовал физический сервер для минимизации различных точек отказа и необходимости максимальной производительности. Если вдруг это BD Oracle использовался SPARC вообще конфетка будет, только очень дорогая конфетка. Чтоб совсем надежно то настроил RAC кластер или ADG.                                                                                                                                                                                                                           |
| Различные web-приложения.                                                                 | виртуализация уровня ОС                                   | быстрая дистрибьюция изменений, гибкое масштабирование всегда оперативно можно развернуть дополнительные сервисы по кнопке, меньше требования к ресурсам.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| Windows системы для использования бухгалтерским отделом.          | паравиртуализация                                             | на базе Hyper-V т.к. удобно эксплуатировать быстрое развертывание и выполнение базовых задач по сопровождению.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| Системы, выполняющие высокопроизводительные расчеты на GPU. | физический сервер/виртуализация уровня ОС | Изначально я думал, что идеальным решением будет это физический сервер проще все настроить и гарантировать высокую производительность. Потом поискал немного в интернете и почитал вот это: <br />1) https://docs.openshift.com/container-platform/4.6/serverless/integrations/gpu-resources.html <br />2) https://docs.nvidia.com/datacenter/cloud-native/gpu-operator/openshift/contents.html <br />3) https://egallen.com/gpu-operator-openshift-43-openstack-13/ <br />допускаю, что идея использовать виртуализацию уровня ОС неплохо звучит. |

## Задача №3

**Вопрос:** Выберите подходящую систему управления виртуализацией для предложенного сценария. Детально опишите ваш выбор.

**Сценарий 1.** 100 виртуальных машин на базе Linux и Windows, общие задачи, нет особых требований. Преимущественно Windows based инфраструктура, требуется реализация программных балансировщиков нагрузки, репликации данных и автоматизированного механизма создания резервных копий.

**Ответ:** Я бы выбрал VMWare, хотя задачу можно и решить на базе Hyper-V. Гипервизоры поддерживают ВМ на базе Linux и Windows. Но исходя из своего опыта я бы не раздумывая взял VMWare. 100 ВМ это значит кластер и не один физический сервер, часто потребуются технологические работы и быстрое гибкое управление ВМ, которое можно организовать через VC. Все что нужно уже есть под капотом балансировка, репликация, бэкапы.

**Сценарий 2.** Требуется наиболее производительное бесплатное open source решение для виртуализации небольшой (20-30 серверов) инфраструктуры на базе Linux и Windows виртуальных машин.

**Ответ:** KVM, Xen– первый по опыту более производительный, оба open source решения подходит для небольшого кол-во ВМ и неплохо поддерживают необходимые гостевые ОС.

**Сценарий 3.** Необходимо бесплатное, максимально совместимое и производительное решение для виртуализации Windows инфраструктуры.

**Ответ:** Идеально подойдет Hyper-V Server максимальная совместимость с Windowsинфраструктурой и бесплатный

**Сценарий 4.** Необходимо рабочее окружение для тестирования программного продукта на нескольких дистрибутивах Linux.

**Ответ:** В данном случае возможно потребуется исходить из компетенций того, кто будет следить за этим окружением. «тестирование программного обеспечения» - это может подразумевать, что сам инженер тестирования успешно справиться с задачами сопровождения сам в продуктах: Parallels, VirtualBox, VMware Horizon. Если это требуется глобальное окружение с большим количеством гостевых ОС (тестовый полигон, SandBox) в данном случае я взял бы, что-то по серьезней с минимальными затратами на сопровождение OpenShift с автодеплоями инфраструктуры и приложения при наличие такой зрелости или KVM(Proxmox) если статичные изолированные ВМ.

## Задача №4

**Вопрос:** Опишите возможные проблемы и недостатки гетерогенной среды виртуализации (использования нескольких систем управления виртуализацией одновременно) и что необходимо сделать для минимизации этих рисков и проблем. Если бы у вас был выбор, то создавали бы вы гетерогенную среду или нет? Мотивируйте ваш ответ примерами.

**Ответ:** За весь мой опыт в различных крупных компания РФ везде была максимально гетерогенная среда. Боюсь в таких масштабах никогда не будет по-другому. Сейчас используется три целевых и есть некоторые подходы и стандарты в разных случаях. Но кажется, что все привыкли и уже знают, как поступать в тех или иных ситуациях. Компании масштаба страны, решают все возможные проблемы и недостатки и имеют некую наработанную базу знаний и пережили уже разные жизненные ситуаций развития и миграции инфраструктуры это постоянный процесс развития.

Возможные **проблемы и недостатки гетерогенной среды** виртуализации:

* квалифицированные компетенции по каждой виртуализации;
* высокая стоимость;
* потребуются гетерогенные решения СХД и СРК, возможно ЛВС;
* сложности масштабируемости решений;
* сложности миграции.

Что необходимо сделать для **минимизации** этих **рисков**:

* иметь стандарты и подходы;
* мы под себя разработали свой аналог AWS (управление базовыми
  сервисам из одного окна не зависимо, что там под капотом. Но понятное дело не все
  готовы потянуть такую задачу, но многие публичные сервисы дают свой API т.е. рассмотреть разные IaaS
  и оценить затраты);
* DevOps (автоматизировать ручные действия).

**Вопрос:** Если бы у вас был выбор, то создавали бы вы гетерогенную среду или нет?

**Ответ:** Для коммерческих компаний необходимо отталкиваться от потребностей и целей бизнеса. Сейчас в эпоху микросерверных приложений. Я хочу в своих стартапах использовать один тип виртуализации. Не тратить время на постоянное выравнивание подходов для решения эксплуатационных задач.
